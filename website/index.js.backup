export class Token {
	constructor(token, expirationDate) {
			this.token = token || '';
			this.expirationDate = expirationDate || 0;
	}
}
export class Account {
	constructor(username, password) {
			this.username = username;
			this.password = password;
	}
}

export class ResponseTokenMessage {
    constructor(token, error) {
        this.token = token;
        this.error = error;
    }
}
export class ResponseMessage {
    constructor(type, rtm, rdm) {
        this.type = type;
        this.rtm = rtm || new ResponseTokenMessage(new Token(), false);
        this.rdm = rdm || new ResponseDataMessage('', false);
    }
}
export class ResponseDataMessage {
    constructor(data, error) {
        this.data = data;
        this.error = error;
    }
}

export class RequestTokenMessage {
    constructor(account) {
        this.account = account;
    }
}
export class RequestMessage {
    constructor(type, rtm, rdm, rem) {
        this.type = type;
        this.rtm = rtm || new RequestTokenMessage(new Account('', ''));
        this.rdm = rdm || new RequestDataMessage(new Token());
        this.rem = rem || new RequestEditMessage('', new Token());
    }
}
export class RequestDataMessage {
    constructor(token) {
        this.token = token;
    }
}
export class RequestEditMessage {
    constructor(data, token) {
        this.data = data;
        this.token = token;
    }
}


const url = 'https://cors-proxy-daniel.herokuapp.com/';
var token;
function setToken(username, password) {
    var xhr = new XMLHttpRequest();
    xhr.open('POST', url, true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.send(JSON.stringify(new RequestMessage('gettoken', new RequestTokenMessage(new Account(username, password)))));
    xhr.onreadystatechange = () => {
        if (xhr.readyState != 4)
            return;
        if (xhr.status == 200) {
            var data = JSON.parse(xhr.responseText);
            if (!data.rtm.error) {
                token = data.rtm.token;
            }
        }
    };
}
function getData() {
    let username = document.getElementById('username-box').value;
    let password = document.getElementById('password-box').value;
    setToken(username, password);
    console.log(token.token);
}
function loadPasswords() {
}
console.log('hello world');
